<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CH Digital Services Chatbot</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DR5B47C0EF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DR5B47C0EF');
  </script>
  <style>
    body { font-family: 'Roboto', sans-serif; background: #000; color: #fff; margin: 0; padding: 0; overflow-x: hidden; }
    canvas#bg { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1; }
    .loader { position: fixed; inset: 0; background: #000; display: flex; align-items: center; justify-content: center; z-index: 9999; }
    .loader span { color: #1f51ff; font-size: 1.2em; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0%, 100% {opacity: 1;} 50% {opacity: 0.5;} }
    .chatbox { max-width: 600px; margin: 60px auto; background: #121212dd; border-radius: 12px; box-shadow: 0 0 20px #1f51ffcc; overflow: hidden; display: flex; flex-direction: column; }
    .chat-header { background: #1f51ff; padding: 1em; display: flex; justify-content: space-between; align-items: center; color: #fff; }
    .chat-header img { border-radius: 50%; width: 40px; height: 40px; box-shadow: 0 0 10px #00f7ff; animation: pulse 3s infinite; }
    .chat-header .status { background: limegreen; padding: 4px 10px; border-radius: 20px; font-size: 0.8em; }
    .messages { padding: 1em; height: 400px; overflow-y: auto; display: flex; flex-direction: column; gap: 1em; }
    .message { max-width: 80%; padding: 0.75em 1em; border-radius: 10px; animation: fadeIn 0.3s ease-in; }
    .bot { background: #333; align-self: flex-start; }
    .user { background: #1f51ff; align-self: flex-end; }
    .typing { font-style: italic; opacity: 0.7; }
    .input-box { display: flex; border-top: 1px solid #333; background: #1c1c1c; }
    .input-box input { flex: 1; padding: 1em; background: #1c1c1c; color: white; border: none; }
    .input-box button { background: #1f51ff; color: white; padding: 1em; border: none; cursor: pointer; }
    .float-btn, .lang-select { position: fixed; z-index: 999; background: #1f51ff; color: white; padding: 10px 14px; border-radius: 30px; font-size: 0.9em; }
    .float-btn { bottom: 20px; right: 20px; }
    .lang-select { top: 20px; right: 20px; }
    .lang-select select { background: #121212; color: white; border: none; padding: 5px; border-radius: 6px; }
    .upload-section { padding: 10px; text-align: center; background: #1c1c1c; }
    .upload-section input[type='file'] { display: block; margin: 10px auto; color: white; }
    .upload-status { margin-top: 10px; color: lightgreen; font-size: 0.9em; }
    @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
  </style>
</head>
<body>
<canvas id="bg"></canvas>
<div class="lang-select">
  <label>ğŸŒ Language: 
    <select onchange="setLanguage(this.value)">
      <option value="en">English</option>
      <option value="tl">Filipino</option>
      <option value="vi">Vietnamese</option>
    </select>
  </label>
</div>
<div class="loader" id="loader"><span>Loading CH Digital Services...</span></div>
<div class="chatbox" style="display:none">
  <div class="chat-header">
    <div style="display:flex;align-items:center">
      <img src="https://i.ibb.co/k2xHwFFz/Chat-GPT-Image-Jun-23-2025-01-33-11-PM.png" alt="Logo" />&nbsp;CH Digital Services
    </div>
    <span class="status">ğŸŸ¢ Online</span>
  </div>
  <div class="messages" id="messages">
    <div class="message bot" id="welcomeMsg">ğŸ‘‹ Welcome! Please enter your email, phone number, or question to begin:</div>
  </div>
  <div class="input-box">
    <input type="text" id="userInput" placeholder="Type your message..."/>
    <button onclick="sendMessage();gtag('event', 'message_sent');">Send</button>
  </div>
</div>
<div class="upload-section">
  <label for="upload">ğŸ“¤ Upload your ID:</label>
  <input type="file" id="upload" accept="image/*,application/pdf" onchange="uploadFile()" />
  <div class="upload-status" id="uploadStatus"></div>
</div>
<div class="float-btn" onclick="openFAQ();gtag('event', 'help_clicked');">â“ Help / FAQ</div>
<script>
  const memory = { name: '', contact: '', language: 'en' };
  const LANG = {
    en: { welcome: "ğŸ‘‹ Welcome! Please enter your email, phone number, or question to begin:", faq: "FAQ: 1. Start Recovery 2. Upload ID 3. Track Request 4. Contact Support\nYou can also ask questions like 'How long does recovery take?'" },
    tl: { welcome: "ğŸ‘‹ Kamusta! Pakilagay ang iyong email, numero, o tanong para makapagsimula:", faq: "FAQ: 1. Simulan ang Pag-recover 2. Mag-upload ng ID 3. Subaybayan ang Request 4. Makipag-ugnayan\nPwede ka ring magtanong tulad ng 'Gaano katagal ang proseso?'" },
    vi: { welcome: "ğŸ‘‹ Xin chÃ o! Vui lÃ²ng nháº­p email, sá»‘ Ä‘iá»‡n thoáº¡i hoáº·c cÃ¢u há»i Ä‘á»ƒ báº¯t Ä‘áº§u:", faq: "FAQ: 1. Báº¯t Ä‘áº§u khÃ´i phá»¥c 2. Táº£i lÃªn ID 3. Theo dÃµi yÃªu cáº§u 4. LiÃªn há»‡ há»— trá»£\nBáº¡n cÅ©ng cÃ³ thá»ƒ há»i 'KhÃ´i phá»¥c máº¥t bao lÃ¢u?'" }
  };
  function setLanguage(code) {
    memory.language = code;
    document.getElementById("welcomeMsg").innerText = LANG[code].welcome;
  }
  function openFAQ() { alert(LANG[memory.language].faq); }
  window.onload = () => {
    gtag('event', 'chat_opened');
    setTimeout(() => {
      document.getElementById('loader').style.display = 'none';
      document.querySelector('.chatbox').style.display = 'flex';
    }, 800);
  };
  const messages = document.getElementById("messages");
  const input = document.getElementById("userInput");
  function sendMessage() {
    const text = input.value.trim();
    if (!text) return;
    appendMessage(text, 'user');
    input.value = '';
    const typing = document.createElement('div');
    typing.className = 'message bot typing';
    typing.innerText = 'Typing...';
    messages.appendChild(typing);
    messages.scrollTop = messages.scrollHeight;
    setTimeout(() => {
      typing.remove();
      respondToUser(text);
    }, 1000);
  }
  function respondToUser(msg) {
    const lower = msg.toLowerCase();
    let response = "ğŸ¤– I'm not sure I understand yet. Please type 1-4 or ask a question like 'How long does recovery take?'";
    if (lower.includes("@") || lower.match(/\d{10,}/)) {
      memory.contact = msg;
      response = `ğŸ“§ Thanks! Iâ€™ve saved your contact: ${memory.contact}`;
    } else if (lower.includes("lost") || lower.includes("disabled") || lower.includes("need help")) {
      response = `ğŸ˜Ÿ I'm here for you! Would you like to:
1ï¸âƒ£ Start a recovery: <a href='https://chdsform.github.io/chds-appeal-form' target='_blank'>Start Now</a><br>2ï¸âƒ£ Upload ID below ğŸ‘‡`;
    } else if (lower.includes("upload")) {
      response = `ğŸ“¤ Please scroll down to upload your government ID directly below.`;
    } else if (lower.includes("how") && lower.includes("long")) {
      response = `â³ Most recoveries take 24â€“48 hours. We'll notify you once it's processed.`;
    } else if (lower.includes("what") && lower.includes("needed")) {
      response = `ğŸ“‹ Required: <br>- Government ID<br>- Linked email or phone<br>- Reason for appeal`;
    } else if (lower === "1") {
      response = `ğŸ”§ Start your recovery: <a href='https://chdsform.github.io/chds-appeal-form' target='_blank'>CHDS Appeal Form</a>`;
    } else if (lower === "2") {
      response = `ğŸ“¤ Upload your ID below ğŸ‘‡`;
    } else if (lower === "3") {
      response = `ğŸ“Š Track your request here: <a href='https://chdsform.github.io/status-check' target='_blank'>Track Now</a>`;
    } else if (lower === "4") {
      response = `ğŸ“¨ Contact support: <a href='https://m.me/CharlesCHDS' target='_blank'>Message Now</a>`;
    } else if (lower.includes("hi") || lower.includes("hello")) {
      response = `ğŸ‘‹ Hi! I'm CHDS Bot. I can help you with:<br>1ï¸âƒ£ Account Recovery<br>2ï¸âƒ£ Upload ID<br>3ï¸âƒ£ Track Request<br>4ï¸âƒ£ Contact Support`; 
    }
    appendMessage(response, 'bot');
  }
  function appendMessage(content, sender) {
    const msg = document.createElement('div');
    msg.className = `message ${sender}`;
    msg.innerHTML = content;
    messages.appendChild(msg);
    messages.scrollTop = messages.scrollHeight;
  }
  function uploadFile() {
    const file = document.getElementById('upload').files[0];
    if (!file) return;
    document.getElementById('uploadStatus').innerText = "Uploading...";
    gtag('event', 'upload_started');
    setTimeout(() => {
      document.getElementById('uploadStatus').innerText = `âœ… ${file.name} uploaded successfully!`;
      gtag('event', 'upload_success');
    }, 2000); // simulate upload
  }
</script>
</body>
</html>
